------------------------------------------ Curso 2020/21 --------------------------------------------

-----To do:

Añadir seguridad en la conexión con los dispositivos MQTT
		Dentro de kubernetes:				
			Introducir una nueva configuracion dentro de la imagen
			Mirar certificados Ingress
		Fuera de kubernetes:
			Comprobar usr + pwd

Cambiar métodos de acceso al cluster: Transformar todo en ingress, quitar metallb
	Añadir los secretos como objeto api de kubernetes
	Quitar la comprobación del certificado en las partes sin acceso externo del cluster

Cosas para mejorar la implementación:
	Utilizar Ingress sin la opción ssl passthrough
	Utilizar configmaps a la hora de mandar archivos y ¿comandos? a las imagenes, asi no tenemos que crear imagenes personalizadas

---- Doing:

Problemas con certificado (funciona en portatil pero no en torre ¿?): crear de 0 y cambiar CA dentro de la configuración del broker
Mover la configuración TLS al broker interior en kubernetes
	Se ha introducido de forma regulera, hacerlo ahora con configmaps?

---- Questions:
Como saber que ip/nombre de dns poner en el certificado?

-----DONE:

Utilizar conexiones TLS con cert en el servidor
	Fuera de kubernetes:
		Hacer funcionar MQTT/TLS --> No hace falta sobre HTTP
	Dentro de kubernetes:
	Investigando sobre Metallb e Ingress --> Vamos a realizar el acceso al cluster por ingress, quitamos metallb.

Montar mqtt sobre http fuera de kubernetes --> No hace falta, se pueden exponer servicios tcp en el ingress. Probar con la red de casa.
	Hay que modificar los archivos de microk8s en snap, y para ello hay que desmontar el sistema de archivos porque es de solo lectura --> ver comandos
	Hay que arreglar conectarse al servicio tcp expuesto --> habia que volver a activar el addon ingress de microk8s para que se actualizaran los yaml modificados
	Probar a acceder desde otro dispositivo en la red de casa a los servicios expuestos en el pc. --> funciona
	

--------------------------------------- Curso 19/20 TFG ENTREGADO ---------------------------------------

-----DONE:

Investigar sobre docker y kubernetes
	Hacer tutoriales

Investigar sobre mosquitto
	Hacer tutoriales

Crear primer pod personalizado (mosquitto broker)
	Investigar sobre servicios en kubernetes (Para acceder al pod)
	Probar el pod con sub pub desde fuera

Crear base de datos
	Investigar sobre almacenar datos permanentes en kubernetes
	Investigar sobre replicas (redundancia)
	Crear deployment con mysql
		Acceso distinguido para master (escritura) y para master & esclavos (lectura)

Crear conector entre broker y base de datos
	Investigar librerias en diferentes lenguajes
	Crear script en python
	Investigar como ejecutar script python en pod kubernetes
	Crear deployment con conector

Crear api rest para acceder como usuario a la base de datos
	Investigar lenguajes y librerias para hacer una api rest
	Crear script node js para la api rest
		Conectar con base de datos

Crear metodo de autentificacion
(mirar correos de rodrigo con paginas web)
	Crear registro usuarios en base de datos
	Investigar librerias necesarias para la autentificacion (usaremos jwt y algo de ssl)
	Implementar parte jwt
	Investigar sobre certificados
		Crear certificados propios (CA para  almacenar en el cliente, y certificado de servidor firmado por esa CA para el servidor)
		Añadimos los certificados a la rutas de confianza de ubuntu y de firefox, que usa la suya propia
		Añadir el certificado de servidor al nodejs
		Añadimos tambien HSTS (para que solo vaya por HTTPS)
		Probelema: nombre de dominio del certificado
			Investigar como ha hecho otra gente servidores tls en kubernetes

Realizar mock-up, es decir, definir la comunicación entre las restantes partes del sistema
	Tenemos que conectar servicios internos con TLS.
	Para ello, vamos a necesitar añadir la CA que nosotros hemos creado al node actualizando la variable de entorno de node en el terminal.
		export NODE_EXTRA_CA_CERTS=/home/manuel/tfg/certificados/myCA.pem
		hemos añadido la variable a ent para que no haga falta ponerla siempre.

Relaizar un estudio para la ontologia
	Diseñar una ontologia sencilla
	Adecuar la base de datos a la ontologia
	Adecuar los mensajes mqtt a la ontologia

Realizra un estudio para las politicas de privacidad
	Diseñar un tipo de políticas y reglas sencillas
	Crear un lector de políticas

Realizar un estudio para los algoritmos de privacidad.
	Se va a utilizar una librería para python que implementa k anonnymity entre otras cosas.
	Hay que modificar dicha librería con nuestra ontología
	La idea es que se le envíe a este modulo la lista con los datos que nos interesan y con el sensitive data.
